<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Strength of chemical pastes — pastes • hsds</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Strength of chemical pastes — pastes"><meta name="description" content="A chemical paste product is delivered in casks, and there are
thought to be variations in the mean strength of the paste between delivery
batches. When a batch arrives, the paste is tested by sampling casks from
the batch and then analysing material from the casks. Further sources of
error arise in the sampling and in the analysis. The data come from ten
randomly chosen delivery batches; from each, three casks are selected at
random, and two analyses are carried out on the contents of each selected
cask. The response is the percentage paste strength in the analysed sample."><meta property="og:description" content="A chemical paste product is delivered in casks, and there are
thought to be variations in the mean strength of the paste between delivery
batches. When a batch arrives, the paste is tested by sampling casks from
the batch and then analysing material from the casks. Further sources of
error arise in the sampling and in the analysis. The data come from ten
randomly chosen delivery batches; from each, three casks are selected at
random, and two analyses are carried out on the contents of each selected
cask. The response is the percentage paste strength in the analysed sample."><meta property="og:image" content="https://abohyndoe.github.io/HSDS/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hsds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Strength of chemical pastes</h1>

      <div class="d-none name"><code>pastes.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A chemical paste product is delivered in casks, and there are
thought to be variations in the mean strength of the paste between delivery
batches. When a batch arrives, the paste is tested by sampling casks from
the batch and then analysing material from the casks. Further sources of
error arise in the sampling and in the analysis. The data come from ten
randomly chosen delivery batches; from each, three casks are selected at
random, and two analyses are carried out on the contents of each selected
cask. The response is the percentage paste strength in the analysed sample.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="va">pastes</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A data frame with 60 rows and 4 columns:</p><dl><dt>batch</dt>
<dd><p>Factor. Batch number (1 to 10)</p></dd>

<dt>cask</dt>
<dd><p>Factor. Cask number within each cask(1 to 3)</p></dd>

<dt>sample</dt>
<dd><p>Factor. Sample number within each cask (1 or 2)</p></dd>

<dt>strength</dt>
<dd><p>Percentage paste strength in the analysed sample</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Davies, O.L. and Goldsmith, P.L. (eds.) (1972) <em>Statistical
Methods in Research and Production</em>, 4th Edition, Edinburgh: Oliver and
Boyd, 136.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Davies and Goldsmith use the following data to demonstrate the use
of analysis of variance in a hierarchical situation where the aim is to
estimate variance components.</p>
<p>This data is also useful to demonstrate the difference between crossed and
nested random effect structures in linear mixed models in R using the
<code>lme4</code> package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The cask numbers are not uniquely defined across batches</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">cask</span>, <span class="va">pastes</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      cask</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> batch 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1  2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2  2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4  2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5  2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6  2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    7  2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    8  2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    9  2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    10 2 2 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This can lead to a "crossed" random effect design if the model terms are</span></span></span>
<span class="r-in"><span><span class="co"># not correctly specified</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">strength</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">batch</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">cask</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">pastes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear mixed model fit by REML ['lmerMod']</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: strength ~ (1 | batch) + (1 | cask)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Data: pastes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML criterion at convergence: 301.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scaled residuals: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.49025 -0.90096 -0.01247  0.62911  1.82246 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Groups   Name        Variance Std.Dev.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  batch    (Intercept) 3.3639   1.8341  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cask     (Intercept) 0.1487   0.3856  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residual             7.3060   2.7030  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of obs: 60, groups:  batch, 10; cask, 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  60.0533     0.7125   84.28</span>
<span class="r-in"><span><span class="co"># The model identifies 3 different casks used repeatedly over the 10 batches (WRONG)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">$</span><span class="va">ngrps</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> batch  cask </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    10     3 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specifying the random effect structure avoids this issue, and correctly leads</span></span></span>
<span class="r-in"><span><span class="co"># to a "nested" random effect structure</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">strength</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">batch</span> <span class="op">/</span> <span class="va">cask</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">pastes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear mixed model fit by REML ['lmerMod']</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: strength ~ (1 | batch/cask)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Data: pastes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML criterion at convergence: 247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scaled residuals: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.4798 -0.5156  0.0095  0.4720  1.3897 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Groups     Name        Variance Std.Dev.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cask:batch (Intercept) 8.434    2.9041  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  batch      (Intercept) 1.657    1.2874  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Residual               0.678    0.8234  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of obs: 60, groups:  cask:batch, 30; batch, 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  60.0533     0.6769   88.72</span>
<span class="r-in"><span><span class="co"># There are indeed 30 combinations of casks and batches (3 *different* casks used</span></span></span>
<span class="r-in"><span><span class="co"># in each batch)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">$</span><span class="va">ngrps</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cask:batch      batch </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         30         10 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bohyn Alexandre.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

